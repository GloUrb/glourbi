# WARNING - Generated by {fusen} from dev/flat_global_map.Rmd: do not edit by hand

#' global_map Title
#' @param varname a string corresponding to one of the variables in all_cities. Defaults to X2018
#' @return a leaflet map
#' @export
#'
#' @examples
#' global_map("X2018")
global_map <- function(varname="X2018") {
  vars=sep_data(all_cities)
  pal=form_palette(varname)
  all_cities=all_cities %>% 
    dplyr::mutate(colors=pal(all_cities[[varname]]))
  map= leaflet::leaflet(all_cities) %>% 
       leaflet::addTiles() %>% 
       leaflet::addCircleMarkers(col=~colors)
  return(map)
}
